<project name="DictionaryWriter" default="default" basedir=".">

    <taskdef name="bundleapp" classname="com.oracle.appbundler.AppBundlerTask" classpath="lib/appbundler-1.0.jar"/>

    <property environment="env"/>

    <property name="projectname" value="DictionaryWriter"/>
    <property name="appname" value="DictionaryWriter"/>
    <property name="bundlename" value="Dictionary Writer"/>
    <property name="mainclass" value="com.nlbuescher.dictionarywriter.DictionaryWriter"/>
    <property name="artifact.dir" value="out/artifacts/DictionaryWriter_jar"/>
    <property name="release.dir" value="release"/>

    <!-- clean -->
    <target name="clean">
        <mkdir dir="${release.dir}"/>
        <delete dir="${release.dir}/DictionaryWriter.app"/>
        <delete file="${release.dir}/${appname}_mac.zip"/>
    </target>

    <!-- create mac osx 'bundle' -->
    <target name="create-bundle">
        <copy file="${artifact.dir}/${projectname}.jar" tofile="${release.dir}/${appname}.jar"/>
        <bundleapp
                outputdirectory="${release.dir}"
                name="${bundlename}"
                displayname="${bundlename}"
                identifier="${mainclass}"
                shortversion="1.0"
                copyright="Nicola L. Buescher"
                applicationCategory="public.app-category.utilities"
                mainclassname="${mainclass}">

            <runtime dir="${env.JAVA_HOME}"/>
            <classpath file="${release.dir}/${appname}.jar"/>

            <option value="-Xdock:icon=Contents/Resources/DictionaryWriter.icns"/>
            <option value="-Dapple.awt.application.name=WikiReader"/>
            <option value="-Dcom.apple.smallTabs=true"/>
            <option value="-Duser.dir=$APP_ROOT/Contents/Resources"/>
        </bundleapp>
        <copy file="style.css" todir="${release.dir}/${bundlename}.app/Contents/Resources"/>
        <copy file="webtransform.xsl" todir="${release.dir}/${bundlename}.app/Contents/Resources"/>
    </target>

    <!-- create zip -->
    <target name="zip">
        <zip basedir="${release.dir}" excludes="${appname}.jar" destfile="${release.dir}/${appname}_mac.zip"/>
    </target>

    <!-- default -->
    <target name="default" depends="clean, create-bundle, zip"/>
</project>